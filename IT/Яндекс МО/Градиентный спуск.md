- Если тебе показать график функции, ты легко определишь ее минимум ([[Понятие наименьшего значения функции]])
- Только вот нам нужно научиться не вычислять минимум вручную, а написать программу ([[программа]]), которая бы эффективно искала минимум. Программа не видит весь график сразу — она может только для каждой точки найти значение функции([[функция_алгебра]]) в этой точке
- **Представь, что ты идешь по извилистым холмам, и тебе нужно найти самую низкую точку — но идешь вслепую и не видишь весь рельеф целиком**
- Но представь: что, если ты будешь идти не совсем вслепую — а освещать окрестности фонариком? Тогда ты увидишь, как рельеф меняется вокруг тебя, и сможешь идти в ту сторону, где высота понижается.
- То же самое и с функцией. Мы начинаем в случайной точке, смотрим, как функция меняется вокруг нее и двигаемся в ту сторону, где она становится меньше.
- [симулятор градиентного спуска](https://yastatic.net/s3/lyceum/files/654bc2b7-c1aa-407f-9e25-f7ab4bad1bfb/upload.html) 
- Но как определять, как функция меняется рядом с текущей точкой?
	- Вот здесь нам и будет нужен [[математический анализ]]. А конкретнее — вычисление [производных](производная.md)!

С помощью вычисления производной можно реализовать алгоритм градиентного спуска для одномерной функции. Градиентный спуск работает для функций разных размерностей. Например, вот так выглядит его в путь по двумерной функции: ![[Pasted image 20250805154102.webp|790]]
Как же нам вычислять направление функции, которая зависит от больше чем одной переменной?
Для этого нам понадобиться новая математика. А конкретно [[Частная производная]]
- Мы начинаем наш спуск в случайной точке 3D-графике. Рядом — изменения графика во все стороны. Что делать? Куда бежать?
- Если задача кажется слишком сложной, ее надо упростить. Нарисуем **срез** нашего графика с зафиксированным `y`: ![[Pasted image 20250805154603.webp]]
- Получилась [[парабола]]. Для нее мы без проблем найдем нужное направление с помощью производной. А теперь давай нарисуем срез с зафиксированным `x`: ![[Pasted image 20250805154622.webp]]
- Если мы отдельно подсчитаем направление движения по x и направление движения по y, то в итоге получим [[вектор]] движения в трехмерном пространстве. То, что нужно!
- ![[Pasted image 20250805154642.webp]]
- Функция на графике ([[График функции]], [[график]]) — это f(x, y) = x2 + y2. При вычислении частной производной по x выражение y2 считаем константой ([[константа]]) — фиксированным числом. Значит, производная равна 2x.
- Частная производная по y, аналогично, равна 2y.

В Python частную производную посчитать так же легко, как и обычную: [[sympy]]

```python
import sympy as sp

# создаем переменные
x, y = sp.symbols('x y')

# задаем функцию
f = x**2 * y + 3*x*y**2

# частная производная по x
df_dx = sp.diff(f, x)

# частная производная по y
df_dy = sp.diff(f, y)

print("Δf/Δx =", df_dx) # напечатает: Δf/Δx = 2*x*y + 3*y**2
print("Δf/Δy =", df_dy) # напечатает: Δf/Δy = x**2 + 6*x*y
```